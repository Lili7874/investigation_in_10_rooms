/* 
Rozstrzygniƒôcie (ukryta prawda ‚Äì poziom 2)

Sprawca: Micha≈Ç
Przedmiot sprawcy: Karafka wina (odciski Micha≈Ça; pojawi≈Ça siƒô na sali tu≈º przed p√≥≈ÇnocƒÖ)
Miejsce morderstwa: Stolik ofiary

Logika:
‚Ä¢ Wydruk log√≥w obala alibi Micha≈Ça (‚Äûodbiera≈Çem telefon‚Äù) ‚Äì brak po≈ÇƒÖcze≈Ñ w krytycznym oknie.
‚Ä¢ Karafka z jego odciskami trafia na st√≥≈Ç tu≈º przed p√≥≈ÇnocƒÖ; z baru znika porcja bitters w tym samym czasie.
‚Ä¢ Kieliszek ofiary ma przetartƒÖ krawƒôd≈∫ ‚Äì ≈õlad podmiany/dolania.
‚Ä¢ Rafa≈Ç krzƒÖta≈Ç siƒô miƒôdzy stolikami (fa≈Çszywy trop), ale nie mia≈Ç kontaktu z barem/karafkƒÖ; Alicja nie opuszcza≈Ça sali na d≈Çu≈ºej; Weronika nie wchodzi≈Ça na zaplecze.
*/

import BaseInvestigationScene from '../BaseInvestigationScene';
import scenaRestauracja from '../assets/scenes/scena_restauracja.png';

// postacie ‚Äì mapowanie: Alicja, Micha≈Ç, Weronika, Rafa≈Ç, Jakub (≈õwiadek)
import character1 from '../assets/avatars/alicja.png';
import character2 from '../assets/avatars/michal.png';
import character3 from '../assets/avatars/weronika.png';
import character4 from '../assets/avatars/rafal.png';
import character5 from '../assets/avatars/jakub.png';

// avatary (ikonki)
import avatar1 from '../assets/avatar_icons/alicja_icon.png';
import avatar2 from '../assets/avatar_icons/michal_icon.png';
import avatar3 from '../assets/avatar_icons/weronika_icon.png';
import avatar4 from '../assets/avatar_icons/rafal_icon.png';
import avatar5 from '../assets/avatar_icons/jakub_icon.png';

export default class LevelRestaurant extends BaseInvestigationScene {
  constructor() {
    super('LevelRestaurant', {
      bgKey: 'bg_restaurant',
      bgSrc: scenaRestauracja,
      title: 'Restauracja o p√≥≈Çnocy',
      intro: `üñº Sceneria:
Elegancka sala restauracyjna, w kt√≥rej na sto≈Çach stojƒÖ niedoko≈Ñczone potrawy i niedopite kieliszki. Krzes≈Ça sƒÖ porozstawiane w nie≈Çadzie, a przez drzwi do kuchni dochodzi st≈Çumione kapanie wody. Zegar wskazuje p√≥≈Çnoc.

üìñ Historia poziomu:
Podczas uroczystej kolacji w restauracji dosz≈Ço do tragedii. Jeden z go≈õci zosta≈Ç znaleziony martwy, pochylony nad talerzem. Lekarz orzek≈Ç, ≈ºe przyczynƒÖ by≈Ça trucizna, najprawdopodobniej podana w napoju. Ka≈ºdy z obecnych mia≈Ç pow√≥d, by co≈õ ukrywaƒá.

Podejrzani:
‚Ä¢ Alicja ‚Äì pewna siebie i dominujƒÖca. Tego wieczoru prowadzi≈Ça trudnƒÖ rozmowƒô przy stole i widziano, jak odsuwa≈Ça kieliszek, gdy wstawa≈Ça od stolika.  
‚Ä¢ Micha≈Ç ‚Äì jej partner, nie≈õmia≈Çy i wycofany. Wiƒôkszo≈õƒá kolacji spƒôdzi≈Ç w milczeniu, ale na kr√≥tko zniknƒÖ≈Ç z sali, t≈ÇumaczƒÖc siƒô odbieraniem telefonu.  
‚Ä¢ Weronika ‚Äì m≈Çoda aktorka, kt√≥ra przysz≈Ça sama, choƒá twierdzi≈Ça, ≈ºe mia≈Ça spotkaƒá siƒô z re≈ºyserem. Uwa≈ºnie obserwowa≈Ça salƒô, lecz nie chce zdradziƒá wszystkiego, co widzia≈Ça.  
‚Ä¢ Rafa≈Ç ‚Äì ambitny student prawa. Sp√≥≈∫ni≈Ç siƒô i usiad≈Ç tam, gdzie by≈Ço wolne. Twierdzi, ≈ºe nie dotyka≈Ç cudzych kieliszk√≥w, ale inni go≈õcie wskazujƒÖ, ≈ºe krzƒÖta≈Ç siƒô miƒôdzy stolikami.  

≈öwiadek:
‚Ä¢ Jakub ‚Äì dyrektor szko≈Çy, sta≈Çy bywalec restauracji. Twierdzi, ≈ºe stara≈Ç siƒô jedynie uspokajaƒá sytuacjƒô, a jego zeznania mogƒÖ pom√≥c w zrekonstruowaniu wydarze≈Ñ, choƒá sam nie jest podejrzany.

üéØ Cel gracza:
Twoim zadaniem jest przes≈Çuchanie ≈õwiadk√≥w i ustalenie, kto wykorzysta≈Ç zamieszanie, by podaƒá truciznƒô. Tylko cztery osoby sƒÖ podejrzane ‚Äì musisz odkryƒá, kt√≥ra z nich k≈Çamie i jakie by≈Çy prawdziwe wydarzenia tego wieczoru.`,

      // === POZYCJE POSTACI (≈Çuk ‚Äì 4 podejrzanych + ≈õwiadek) ===
      positions: [
        { x: 0.43 * window.innerWidth, y: 0.56 * window.innerHeight }, // Alicja
        { x: 0.68 * window.innerWidth, y: 0.58 * window.innerHeight }, // Micha≈Ç
        { x: 0.56 * window.innerWidth, y: 0.44 * window.innerHeight }, // Weronika
        { x: 0.50 * window.innerWidth, y: 0.72 * window.innerHeight }, // Rafa≈Ç
        { x: 0.48 * window.innerWidth, y: 0.32 * window.innerHeight }, // Jakub (≈õwiadek)
      ],

      // === POSTACIE ===
      characters: [
        { key: 'character1', src: character1, text: 'Nie przestawia≈Çam niczyjego kieliszka.', avatar: { key: 'avatar1', src: avatar1 } }, // Alicja
        { key: 'character2', src: character2, text: 'Na chwilƒô wyszed≈Çem odebraƒá telefon.',  avatar: { key: 'avatar2', src: avatar2 } }, // Micha≈Ç
        { key: 'character3', src: character3, text: 'Widzia≈Çam du≈ºo, ale nie wszystko powiem‚Ä¶', avatar: { key: 'avatar3', src: avatar3 } }, // Weronika
        { key: 'character4', src: character4, text: 'Nie dotyka≈Çem cudzych kieliszk√≥w.',     avatar: { key: 'avatar4', src: avatar4 } }, // Rafa≈Ç
        { key: 'character5', src: character5, text: 'Spokojnie, spr√≥bujmy odtworzyƒá kolejno≈õƒá.', avatar: { key: 'avatar5', src: avatar5 } }, // Jakub
      ],

      // === PRZEDMIOTY (4) ===
      items: [
        {
          key: 'kieliszek_ofiary',
          name: 'Kieliszek ofiary',
          text: 'Resztka napoju o gorzkim posmaku; przetarta krawƒôd≈∫ ‚Äì ≈õlad manipulacji.',
          src: require('../assets/items/kieliszek.png'),
          avatar: { key: 'kieliszek_ofiary', src: require('../assets/items/kieliszek.png') },
          scale: 0.05,
        },
        {
          key: 'karafka_wina',
          name: 'Karafka wina',
          text: 'Odciski Micha≈Ça; karafka pojawi≈Ça siƒô na sali tu≈º przed p√≥≈ÇnocƒÖ.',
          src: require('../assets/items/karafka.png'),
          avatar: { key: 'karafka_wina', src: require('../assets/items/karafka.png') },
          scale: 0.05,
        },
        {
          key: 'butelka_bitters',
          name: 'Butelka bitters (bar)',
          text: 'Nienaturalny ubytek; barman m√≥wi, ≈ºe ‚Äûkto≈õ wziƒÖ≈Ç na chwilƒô‚Äù.',
          src: require('../assets/items/bitters.png'),
          avatar: { key: 'butelka_bitters', src: require('../assets/items/bitters.png') },
          scale: 0.05,
        },
        {
          key: 'logi_michal',
          name: 'Wydruk log√≥w po≈ÇƒÖcze≈Ñ Micha≈Ça',
          text: 'W czasie rzekomego ‚Äûtelefonu‚Äù brak po≈ÇƒÖcze≈Ñ przychodzƒÖcych/wychodzƒÖcych.',
          src: require('../assets/items/telefon_wydruk.png'),
          avatar: { key: 'logi_michal', src: require('../assets/items/telefon_wydruk.png') },
          scale: 0.05,
        },
      ],

      // === MIEJSCA (4) ===
      places: [
        {
          key: 'stolik_ofiary',
          name: 'Stolik ofiary',
          text: 'Miejsce zgonu; kieliszek przestawiany kilkukrotnie.',
          src: require('../assets/places/stolik.png'),
          avatar: { key: 'stolik_ofiary', src: require('../assets/places/stolik.png') },
          scale: 0.05,
        },
        {
          key: 'bar',
          name: 'Bar',
          text: 'Tu stojƒÖ bitters i zapasowe karafki; barman bywa odwr√≥cony plecami.',
          src: require('../assets/places/bar.png'),
          avatar: { key: 'bar', src: require('../assets/places/bar.png') },
          scale: 0.05,
        },
        {
          key: 'korytarz_kuchnia',
          name: 'Korytarz do kuchni',
          text: 'Martwy punkt kamer; tƒôdy Micha≈Ç znika na kilka minut.',
          src: require('../assets/places/korytarz_kuchnia.png'),
          avatar: { key: 'korytarz_kuchnia', src: require('../assets/places/korytarz_kuchnia.png') },
          scale: 0.05,
        },
        {
          key: 'sala_glowna',
          name: 'Sala g≈Ç√≥wna',
          text: 'Porozstawiane krzes≈Ça; ≈Çatwo wmieszaƒá siƒô miƒôdzy stoliki (trop na Rafa≈Ça).',
          src: require('../assets/places/sala_restauracyjna.png'),
          avatar: { key: 'sala_glowna', src: require('../assets/places/sala_restauracyjna.png') },
          scale: 0.05,
        },
      ],

      // === POZYCJE PRZEDMIOT√ìW (kolejno≈õƒá jak w "items") ===
      itemPositions: [
        { x: 0.59 * window.innerWidth, y: 0.35 * window.innerHeight }, // kieliszek_ofiary
        { x: 0.48 * window.innerWidth, y: 0.44 * window.innerHeight }, // karafka_wina
        { x: 0.36 * window.innerWidth, y: 0.72 * window.innerHeight }, // butelka_bitters
        { x: 0.62 * window.innerWidth, y: 0.70 * window.innerHeight }, // logi_michal
      ],

      // === POZYCJE MIEJSC (kolejno≈õƒá jak w "places") ===
      placePositions: [
        { x: 0.59 * window.innerWidth, y: 0.58 * window.innerHeight }, // stolik_ofiary
        { x: 0.43 * window.innerWidth, y: 0.45 * window.innerHeight }, // bar
        { x: 0.42 * window.innerWidth, y: 0.34 * window.innerHeight }, // korytarz_kuchnia
        { x: 0.36 * window.innerWidth, y: 0.74 * window.innerHeight }, // sala_glowna
      ],

      // listy dla tablicy dedukcji i podpowiedzi w inputach
      deduction: {
        suspects: ['Alicja', 'Micha≈Ç', 'Weronika', 'Rafa≈Ç'],
        places:   ['Stolik', 'Bar', 'Korytarz', 'Sala'],
        items:    ['Kieliszek', 'Karafka', 'Bitters', 'Logi'],
      },

      // callback po klikniƒôciu ‚ÄûZako≈Ñcz poziom‚Äù
      onDeductionSubmit: ({ suspect, item, place }) => {
        console.log('Gracz wskaza≈Ç:', suspect, item, place);
        // Prawda (poziom 2): Micha≈Ç + Karafka wina + Stolik ofiary
      },
    });
  }
}
