/* 
Rozstrzygniƒôcie (ukryta prawda ‚Äì poziom 7)

Sprawca: Julia
Przedmiot sprawcy: Karta rewersowa manuskryptu (wpis na jej nazwisko; ‚Äûtylko pyta≈Ça‚Äù, ale karta ≈ÇƒÖczy jƒÖ z konkretnym rƒôkopisem)
Miejsce morderstwa: Czytelnia (cia≈Ço znalezione przy przewr√≥conej lampce)

Logika:
‚Ä¢ Ostatnie po≈ÇƒÖczenie na telefonie bibliotekarza 05:58 (zastrze≈ºony) ‚Üí chwilƒô przed 06:00, gdy ≈õwiadek widzi ≈õwiat≈Ço w magazynie.
‚Ä¢ ≈öwiat≈Ço w magazynie w≈ÇƒÖczane/wy≈ÇƒÖczane ok. 06:00 + brak ≈õlad√≥w w≈Çamania do sejfu ‚Üí otwarcie kluczem po namowie/przymusie.
‚Ä¢ Karta rewersowa Julii ≈ÇƒÖczy jƒÖ bezpo≈õrednio z brakujƒÖcym manuskryptem (motyw i pretekst).
‚Ä¢ Kadr z korytarza pokazuje Rafa≈Ça 05:57‚Äì05:59 przy drzwiach magazynu, ale bez wej≈õcia ‚Äî mocny, lecz mylƒÖcy trop.
‚Ä¢ Fina≈Ç w czytelni: przewr√≥cona lampka ≈õwiadczy o szarpaninie, gdzie bibliotekarz pr√≥bowa≈Ç odzyskaƒá manuskrypt.
*/

import BaseInvestigationScene from '../BaseInvestigationScene';
import scenaBiblioteka from '../assets/scenes/scena_biblioteka_miejska.png';

// postacie ‚Äì mapowanie: Rafa≈Ç, Julia, Jakub, Weronika, Szymon (≈õwiadek)
import character1 from '../assets/avatars/rafal.png';
import character2 from '../assets/avatars/julia.png';
import character3 from '../assets/avatars/jakub.png';
import character4 from '../assets/avatars/weronika.png';
import character5 from '../assets/avatars/szymon.png';

// avatary (ikonki)
import avatar1 from '../assets/avatar_icons/rafal_icon.png';
import avatar2 from '../assets/avatar_icons/julia_icon.png';
import avatar3 from '../assets/avatar_icons/jakub_icon.png';
import avatar4 from '../assets/avatar_icons/weronika_icon.png';
import avatar5 from '../assets/avatar_icons/szymon_icon.png';

export default class LevelLibrary extends BaseInvestigationScene {
  constructor() {
    super('LevelLibrary', {
      bgKey: 'bg_library',
      bgSrc: scenaBiblioteka,
      title: 'Biblioteka o ≈õwicie',
      intro: `üñº Sceneria:
Wysokie rega≈Çy, skrzypiƒÖca pod≈Çoga i zapach kurzu. Na jednym ze sto≈Ç√≥w le≈ºƒÖ rozsypane kartki z katalogu, obok przewr√≥cona lampka. W czytelni wciƒÖ≈º pali siƒô zimne, zielone ≈õwiat≈Ço biurkowe. Drzwi do magazynu ksiƒÖ≈ºek sƒÖ niedomkniƒôte.

üìñ Historia poziomu:
O ≈õwicie znaleziono cia≈Ço nocnego bibliotekarza w czytelni, a z sejfu w magazynie zniknƒÖ≈Ç rzadki manuskrypt. Klucze do sejfu mia≈Çy tylko dwie osoby, ale ≈õlad√≥w w≈Çamania brak. Ostatnie zapisy w ksiƒôdze odwiedzin sƒÖ niekompletne, jakby kto≈õ je wyrwa≈Ç. Wersje zdarze≈Ñ zn√≥w wzajemnie siƒô wykluczajƒÖ.

Podejrzani:
‚Ä¢ Rafa≈Ç ‚Äî ambitny student prawa. Pracowa≈Ç nad pracƒÖ semestralnƒÖ o prawie w≈Çasno≈õci intelektualnej. Twierdzi, ≈ºe przyszed≈Ç oddaƒá ksiƒÖ≈ºki karƒÖ, ale kamera z korytarza rejestruje go tak≈ºe przy drzwiach do magazynu. M√≥wi, ≈ºe ‚Äûszuka≈Ç toalety‚Äù.
‚Ä¢ Julia ‚Äî nauczycielka jƒôzyka polskiego. Na jej karcie rewersowej widnieje brakujƒÖcy manuskrypt, choƒá utrzymuje, ≈ºe ‚Äûtylko o niego pyta≈Ça‚Äù.
‚Ä¢ Jakub ‚Äî dyrektor szko≈Çy. Przyszed≈Ç wcze≈õniej ‚Äûsprawdziƒá stanowiska konkursowe‚Äù na szkolnƒÖ olimpiadƒô. K≈Ç√≥ci≈Ç siƒô z bibliotekarzem o ‚Äûniepotrzebne formalno≈õci‚Äù.
‚Ä¢ Weronika ‚Äî m≈Çoda aktorka. Zaliczono jƒÖ na li≈õcie czytelni jako ‚Äûbadania do roli‚Äù, ale kto≈õ widzia≈Ç, jak z notesem ≈õledzi uk≈Çad kluczy w gablocie. Twierdzi, ≈ºe to tylko improwizacja do roli kustoszki.

≈öwiadek:
‚Ä¢ Szymon ‚Äî starszy sta≈Çy bywalec, czyta codziennie prasƒô. S≈Çabo s≈Çyszy, ale zauwa≈ºy≈Ç, ≈ºe ‚Äûkto≈õ gasi≈Ç i zapala≈Ç ≈õwiat≈Ço w magazynie‚Äù mniej wiƒôcej o tej samej porze, kiedy zegar w hallu wybi≈Ç 6:00. Utrzymuje, ≈ºe bibliotekarz ‚Äûz kim≈õ szepta≈Ç przez telefon‚Äù.

üéØ Cel gracza:
Ustal, kto mia≈Ç realnƒÖ mo≈ºliwo≈õƒá wej≈õcia do magazynu i dostƒôp do sejfu, oraz w jakiej kolejno≈õci przebywano miƒôdzy czytelniƒÖ, ladƒÖ i magazynem. Po≈ÇƒÖcz zebrane informacje, by wskazaƒá osobƒô odpowiedzialnƒÖ za kradzie≈º manuskryptu i ≈õmierƒá bibliotekarza.`,

      // === POZYCJE POSTACI (≈Çuk ‚Äì 5 postaci: 4 podejrzanych + ≈õwiadek) ===
      positions: [
        { x: 0.34 * window.innerWidth, y: 0.58 * window.innerHeight }, // Rafa≈Ç
        { x: 0.46 * window.innerWidth, y: 0.44 * window.innerHeight }, // Julia
        { x: 0.58 * window.innerWidth, y: 0.58 * window.innerHeight }, // Jakub
        { x: 0.40 * window.innerWidth, y: 0.60 * window.innerHeight }, // Weronika
        { x: 0.70 * window.innerWidth, y: 0.58 * window.innerHeight }, // Szymon (≈õwiadek)
      ],

      // === POSTACIE ===
      characters: [
        { key: 'character1', src: character1, text: 'To na pewno pomy≈Çka, tylko oddawa≈Çem ksiƒÖ≈ºki.', avatar: { key: 'avatar1', src: avatar1 } }, // Rafa≈Ç
        { key: 'character2', src: character2, text: 'Mia≈Çam tylko zapytaƒá o rƒôkopis...', avatar: { key: 'avatar2', src: avatar2 } }, // Julia
        { key: 'character3', src: character3, text: 'Nie ≈ºyczƒô sobie insynuacji.', avatar: { key: 'avatar3', src: avatar3 } }, // Jakub
        { key: 'character4', src: character4, text: 'Notowa≈Çam uk≈Çad kluczy do roli!', avatar: { key: 'avatar4', src: avatar4 } }, // Weronika
        { key: 'character5', src: character5, text: '≈öwiat≈Ço miga≈Ço‚Ä¶ tak ko≈Ço sz√≥stej.', avatar: { key: 'avatar5', src: avatar5 } }, // Szymon
      ],

      // === PRZEDMIOTY (opis + grafika; rozmiar przez scale) ===
      items: [
        {
          key: 'telefon',
          name: 'Telefon bibliotekarza',
          text: 'Ostatnie po≈ÇƒÖczenie o 05:58 (numer zastrze≈ºony); notatka ‚Äûprzy sejfie‚Äù.',
          src: require('../assets/items/telefon.png'),
          avatar: { key: 'telefon', src: require('../assets/items/telefon.png') },
          scale: 0.05,
        },
        {
          key: 'karta_rewersowa',
          name: 'Karta rewersowa manuskryptu',
          text: 'Na karcie Julii widnieje brakujƒÖcy manuskrypt; ‚Äûtylko pyta≈Ça‚Äù, ale wpis jƒÖ wiƒÖ≈ºe z rƒôkopisem.',
          src: require('../assets/items/karta_rewersowa.png'),
          avatar: { key: 'karta_rewersowa', src: require('../assets/items/karta_rewersowa.png') },
          scale: 0.05,
        },
        {
          key: 'lampka',
          name: 'Przewr√≥cona lampka',
          text: '≈ölady szarpaniny w czytelni; pot≈Çuczone szk≈Ço, odciski nieczytelne (rƒôkawiczki?).',
          src: require('../assets/items/lampka.png'),
          avatar: { key: 'lampka', src: require('../assets/items/lampka.png') },
          scale: 0.05,
        },
        {
          key: 'kadr',
          name: 'Kadr z korytarza (kamera K-2)',
          text: 'Rafa≈Ç przy drzwiach magazynu 05:57‚Äì05:59; na ujƒôciu nie wchodzi do ≈õrodka.',
          src: require('../assets/items/kadr.png'),
          avatar: { key: 'kadr_korytarz', src: require('../assets/items/kadr.png') },
          scale: 0.05,
        },
      ],

      // === MIEJSCA (jak itemy ‚Äì interaktywne elementy) ===
      places: [
        {
          key: 'czytelnia',
          name: 'Czytelnia',
          text: 'Miejsce zbrodni; zielona lampka w≈ÇƒÖczona, lampka biurkowa przewr√≥cona.',
          src: require('../assets/places/czytelnia.png'),
          avatar: { key: 'czytelnia', src: require('../assets/places/czytelnia.png') },
          scale: 0.05,
        },
        {
          key: 'magazyn_sejf',
          name: 'Magazyn (z sejfem)',
          text: '≈öwiat≈Ço w≈ÇƒÖczane/wy≈ÇƒÖczane ok. 06:00; brak ≈õlad√≥w w≈Çamania do sejfu.',
          src: require('../assets/places/magazyn.png'),
          avatar: { key: 'magazyn_sejf', src: require('../assets/places/magazyn.png') },
          scale: 0.05,
        },
        {
          key: 'lada_ksiega',
          name: 'Lada / ksiƒôga odwiedzin',
          text: 'Wyrwane zapisy; faktyczna kolejno≈õƒá wej≈õƒá ukryta.',
          src: require('../assets/places/lada.png'),
          avatar: { key: 'lada_ksiega', src: require('../assets/places/lada.png') },
          scale: 0.05,
        },
        {
          key: 'korytarz_kamera',
          name: 'Korytarz z kamerƒÖ',
          text: 'Ujƒôcie Rafa≈Ça ko≈Ço magazynu (05:57‚Äì05:59); koreluje z 06:00 z zegara w hallu.',
          src: require('../assets/places/korytarz.png'),
          avatar: { key: 'korytarz_kamera', src: require('../assets/places/korytarz.png') },
          scale: 0.05,
        },
      ],

      // === POZYCJE PRZEDMIOT√ìW (kolejno≈õƒá jak w "items") ===
      itemPositions: [
        { x: 0.40 * window.innerWidth, y: 0.40 * window.innerHeight }, // telefon_bibliotekarza
        { x: 0.55 * window.innerWidth, y: 0.38 * window.innerHeight },// karta_rewersowa
        { x: 0.50 * window.innerWidth, y: 0.66 * window.innerHeight },	// lampka_przewrocona	
        { x: 0.40 * window.innerWidth, y: 0.75 * window.innerHeight }, // kadr_korytarz
      ],

      // === POZYCJE MIEJSC (kolejno≈õƒá jak w "places") ===
      placePositions: [
        { x: 0.65 * window.innerWidth, y: 0.52 * window.innerHeight }, // czytelnia
        { x: 0.50 * window.innerWidth, y: 0.46 * window.innerHeight }, // magazyn_sejf
        { x: 0.35 * window.innerWidth, y: 0.44 * window.innerHeight }, // lada_ksiega
        { x: 0.30 * window.innerWidth, y: 0.72 * window.innerHeight }, // korytarz_kamera
      ],

      // listy dla tablicy dedukcji i podpowiedzi w inputach
      deduction: {
        suspects: ['Rafa≈Ç', 'Julia', 'Jakub', 'Weronika'],
        places:   ['Czytelnia', 'Magazyn', 'Lada', 'Korytarz'],
        items:    ['Telefon', 'Karta', 'Lampka', 'Kadr'],
      },

      // callback po klikniƒôciu ‚ÄûZako≈Ñcz poziom‚Äù
      onDeductionSubmit: ({ suspect, item, place }) => {
        console.log('Gracz wskaza≈Ç:', suspect, item, place);
        // Prawda (poziom 7): Julia + Karta rewersowa manuskryptu + Czytelnia
      },
    });
  }
}
